<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="Rubén Arcos | Web & Apps developer" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="Rubén Arcos | Web & Apps developer" /> <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous"> <title> Hilos en JAVA, ejercicio nivel avanzado 1.2 (consola) - Rubén Arcos | Web & Apps developer </title> <link rel="alternate" href="http://localhost:4000/hilos-en-java-ejercicio-1/" hreflang="en-US" /> <link rel="canonical" href="http://localhost:4000/hilos-en-java-ejercicio-1/" /> <meta name="description" content="Web &amp; Apps developer @github. Being a programmer is my project, help the user my purpose and, automate my definition processes" /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="Hilos en JAVA, ejercicio nivel avanzado 1.2 (consola) | Rubén Arcos" /> <meta property="og:title" content="Hilos en JAVA, ejercicio nivel avanzado 1.2 (consola) | Rubén Arcos" /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/hilos-en-java-ejercicio-1/" /> <meta property="og:description" content="Web &amp; Apps developer @github. Being a programmer is my project, help the user my purpose and, automate my definition processes" /> <meta property="og:image" content="http://localhost:4000/assets/img/ogp.png" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Hilos en JAVA, ejercicio nivel avanzado 1.2 (consola) | twitter_username" /> <meta name="twitter:url" content="http://localhost:4000/hilos-en-java-ejercicio-1/" /> <meta name="twitter:site" content="@twitter_username" /> <meta name="twitter:creator" content="@twitter_username" /> <meta name="twitter:description" content="Web &amp; Apps developer @github. Being a programmer is my project, help the user my purpose and, automate my definition processes" /> <meta name="twitter:image" content="http://localhost:4000/assets/img/ogp.png" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> </head> <body data-theme="light" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">Home</a><a class="menu-link" href="/archive/">Labs & arts</a><a class="menu-link" href="/cv/">About & CV</a><a class="menu-link" href="/contacto/">Contact</a><a class="menu-link" href="https://github.com/rubenarcos2" target="_blank" rel="noopener" ><i class="fab fa-github fa-2x"></i></a ><a class="menu-link" href="https://es.linkedin.com/in/rubenarcos2" target="_blank" rel="noopener" ><i class="fab fa-linkedin fa-2x"></i></a ><!-- <a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> --> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <h1 class="header-title" itemprop="headline">Hilos en JAVA, ejercicio nivel avanzado 1.2 (consola)</h1> <div class="post-meta"> <time datetime="2016-01-28T00:00:00+00:00" itemprop="datePublished"> 28 Jan, 2016 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">Rubén Arcos</span> <a href="https://github.com/rubenarcos2" target="_blank" rel="noopener">@github</a> </span> <time hidden datetime="" itemprop="dateModified"> 28 Jan, 2016 </time> <span hidden itemprop="publisher" itemtype="Person">Rubén Arcos</span> <span hidden itemprop="image"></span> <span hidden itemprop="mainEntityOfPage"><p>A continuación se muestra una serie de 8 ejercicios que voya a ir mostrando tanto en consola como de forma gráfica mediante el uso de applets. Cabe de estacar que los he subido en orden incremental de dificultad, puesto que considero que así­ facilitará su compresión y futura aplicación.</p> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <p>A continuación se muestra una serie de 8 ejercicios que voya a ir mostrando tanto en consola como de forma gráfica mediante el uso de applets. Cabe de estacar que los he subido en orden incremental de dificultad, puesto que considero que así­ facilitará su compresión y futura aplicación.</p> <p>Considero que el código es suficientemente explicativo como para no tener que documentarlo de forma explí­cita, no obstante si tienes alguna duda déjame un comentario y te lo explico lo antes posible.</p> <p>El ejercicio está representado mediante lo cola de espera de un supermercado. Habiendo una caja por la cual se realizará el cobro de los productos y un número aleatorio de clientes por cada ejecución de la aplicación como de productos. La sincronización de los hilos se realiza en la caja (Pipe), la cual solo podrá cobrar un cliente y el resto se encontrarán a la espera. Recordar que tanto los clientes como los productos que lleva cada uno en su cesta se generará de forma aleatoria al comienzo de la aplicación. Se ha asignado un tiempo de espera de 1 segundo por el cobro de cada producto unitario.</p> <p> </p> <p><img src="Jerarquia_clases_ejercicio_hilos_1.jpg" alt="Jerarquia_clases_ejercicio_hilos_1" /></p> <p><strong>Clase principal</strong> <em>(Main.java)</em> Es la que se ejecutará en primera instancia, y contendrá un array de clientes y realizará tanto la creación de la caja (Pipe) como de los clientes (Threads).</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">Hilo.Hilo</span><span class="o">;</span> 
<span class="kn">import</span> <span class="nn">Hilo.Pipe</span><span class="o">;</span> 
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>

<span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">numClientes</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span> <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">numProductos</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span> <span class="kd">private</span> <span class="kd">static</span> <span class="nc">ArrayList</span><span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span><span class="nc">Hilo</span><span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">amp</span><span class="o">;</span><span class="n">gt</span><span class="o">;</span> <span class="n">listaClientes</span><span class="o">;</span> <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Pipe</span> <span class="n">caja</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="err">\</span><span class="o">[</span><span class="err">\</span><span class="o">]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span> <span class="n">caja</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Pipe</span><span class="o">(</span><span class="n">numClientes</span><span class="o">);</span> <span class="n">listaClientes</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">amp</span><span class="o">;</span><span class="n">gt</span><span class="o">;();</span> <span class="n">iniciarCaja</span><span class="o">();</span> <span class="n">iniciarCobroCliente</span><span class="o">();</span> <span class="o">}</span>

<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">iniciarCaja</span><span class="o">()</span> <span class="o">{</span> <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="n">caja</span><span class="o">.</span><span class="na">generarAleatorio</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">numClientes</span><span class="o">);</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"El cliente "</span> <span class="o">+</span> <span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">+</span> <span class="s">" se ha puesto en cola."</span><span class="o">);</span> <span class="n">listaClientes</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Hilo</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">numProductos</span><span class="o">,</span> <span class="n">caja</span><span class="o">));</span> <span class="o">}</span> <span class="o">}</span>

<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">iniciarCobroCliente</span><span class="o">()</span> <span class="o">{</span> <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="n">listaClientes</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span> <span class="n">listaClientes</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">start</span><span class="o">();</span> <span class="o">}</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\\nPasen por caja por favor..."</span><span class="o">);</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"---------------------------"</span><span class="o">);</span> <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div> <p><strong>Clase Cliente</strong> <em>(Hilo.java)</em> Esta clase es la que se va a ir ejectando por cada hilo, es el hilo propiamente. Por ello el constructor, nos devolverás sus propiedades, tales como el nombre o el Pipe en el que se encuentra en el momento.</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">Hilo</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Hilo</span> <span class="kd">extends</span> <span class="nc">Thread</span> <span class="o">{</span>

<span class="kd">private</span> <span class="nc">Pipe</span> <span class="n">caja</span><span class="o">;</span> <span class="kd">private</span> <span class="kt">int</span> <span class="n">nombre</span><span class="o">,</span> <span class="n">ultimoCobrado</span><span class="o">;</span> <span class="kd">private</span> <span class="kt">int</span><span class="err">\</span><span class="o">[</span><span class="err">\</span><span class="o">]</span> <span class="n">productos</span><span class="o">;</span>

<span class="kd">public</span> <span class="nf">Hilo</span><span class="o">(</span><span class="kt">int</span> <span class="n">nombre</span><span class="o">,</span> <span class="kt">int</span> <span class="n">numProductos</span><span class="o">,</span> <span class="nc">Pipe</span> <span class="n">caja</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">nombre</span> <span class="o">=</span> <span class="n">nombre</span><span class="o">;</span> <span class="k">this</span><span class="o">.</span><span class="na">caja</span> <span class="o">=</span> <span class="n">caja</span><span class="o">;</span> <span class="n">ultimoCobrado</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span> <span class="k">this</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">nombre</span><span class="o">));</span> <span class="n">productos</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="err">\</span><span class="o">[</span><span class="n">caja</span><span class="o">.</span><span class="na">generarAleatorio</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">numProductos</span><span class="o">)</span><span class="err">\</span><span class="o">];</span> <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="n">productos</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span> <span class="n">productos</span><span class="err">\</span><span class="o">[</span><span class="n">i</span><span class="err">\</span><span class="o">]</span> <span class="o">=</span> <span class="n">caja</span><span class="o">.</span><span class="na">generarAleatorio</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span> <span class="o">}</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"El cliente "</span> <span class="o">+</span> <span class="o">(</span><span class="n">nombre</span><span class="o">)</span> <span class="o">+</span> <span class="s">" lleva en la cesta "</span> <span class="o">+</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">productos</span><span class="o">));</span> <span class="o">}</span>

<span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span> <span class="k">try</span> <span class="o">{</span> <span class="k">while</span> <span class="o">(</span><span class="n">ultimoCobrado</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="n">productos</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">{</span> <span class="n">ultimoCobrado</span> <span class="o">=</span> <span class="n">caja</span><span class="o">.</span><span class="na">cobrar</span><span class="o">(</span><span class="n">nombre</span><span class="o">,</span> <span class="n">productos</span><span class="o">);</span> <span class="o">}</span> <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"ERROR: hilo bloqueado. "</span> <span class="o">+</span> <span class="n">ex</span><span class="o">);</span> <span class="o">}</span> <span class="o">}</span>

<span class="o">}</span>

</code></pre></div></div> <p><strong>Clase caja registradora</strong> <em>(Pipe.java)</em></p> <p>Es aquí­ donde se gestiona realmente la sincronización de los hilos. Se realiza el control de que solamente se atienda un hilo (el que primero lo solicite) y que se vayan realizando los cobros de los productos, ‘durmiendo’ la ejecución de este hilo durante 1 seg, el resto de hilos, conforme van solicitando el acceso y se les deniega, se les cambia el estado a ‘dormido’ para optimizar el rendimiento y evitar ciclos inecesarios de procesos independientes que requiere de un recurso que se encuentra ocupado, en este caso nuestra caja registradora.</p> <p>Cuando finaliza la ejecución del hilo, se genera una excepción de interrupción para indicar que se pueden reactivar los hilos que se encontraban a la espera ‘dormidos’.</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">Hilo</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Pipe</span> <span class="o">{</span>

<span class="kd">private</span> <span class="kt">int</span> <span class="n">numClientes</span><span class="o">,</span> <span class="n">ultimoCliente</span><span class="o">,</span> <span class="n">cantProdCob</span><span class="o">;</span> <span class="kd">private</span> <span class="kt">int</span><span class="err">\</span><span class="o">[</span><span class="err">\</span><span class="o">]</span><span class="n">clientes</span><span class="o">;</span>

<span class="kd">public</span> <span class="nf">Pipe</span><span class="o">(</span><span class="kt">int</span> <span class="n">numClientes</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">numClientes</span> <span class="o">=</span> <span class="n">numClientes</span><span class="o">;</span> <span class="n">clientes</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="err">\</span><span class="o">[</span><span class="n">numClientes</span><span class="err">\</span><span class="o">];</span> <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="n">clientes</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span> <span class="n">clientes</span><span class="err">\</span><span class="o">[</span><span class="n">i</span><span class="err">\</span><span class="o">]</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="o">}</span> <span class="n">ultimoCliente</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">cantProdCob</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Se ha abierto la caja"</span><span class="o">);</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"---------------------"</span><span class="o">);</span> <span class="o">}</span>

<span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">int</span> <span class="nf">cobrar</span><span class="o">(</span><span class="kt">int</span> <span class="n">nombreHilo</span><span class="o">,</span> <span class="kt">int</span><span class="err">\</span><span class="o">[</span><span class="err">\</span><span class="o">]</span> <span class="n">productos</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span> <span class="k">if</span> <span class="o">(</span><span class="n">nombreHilo</span> <span class="o">==</span> <span class="n">ultimoCliente</span><span class="o">)</span> <span class="o">{</span> <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="n">productos</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Cobrando...("</span><span class="o">+</span><span class="n">productos</span><span class="err">\</span><span class="o">[</span><span class="n">i</span><span class="err">\</span><span class="o">]+</span><span class="s">" seg.)"</span><span class="o">);</span> <span class="n">clientes</span><span class="err">\</span><span class="o">[</span><span class="n">nombreHilo</span><span class="err">\</span><span class="o">]++;</span> <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">productos</span><span class="err">\</span><span class="o">[</span><span class="n">i</span><span class="err">\</span><span class="o">]</span> <span class="err">\</span><span class="o">*</span> <span class="mi">1000</span><span class="o">);</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Se ha combrado: cliente "</span> <span class="o">+</span> <span class="n">nombreHilo</span> <span class="o">+</span> <span class="s">", producto "</span> <span class="o">+</span> <span class="n">i</span><span class="o">);</span> <span class="o">}</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\\t\\t\\t\\t\\t\*\*\* El cliente "</span> <span class="o">+</span> <span class="n">nombreHilo</span> <span class="o">+</span> <span class="s">" ha pasado todos sus productos."</span><span class="o">);</span> <span class="n">ultimoCliente</span><span class="o">=</span><span class="n">nombreHilo</span><span class="o">+</span><span class="mi">1</span><span class="o">;</span> <span class="n">notifyAll</span><span class="o">();</span> <span class="o">}</span><span class="k">else</span><span class="o">{</span> <span class="n">wait</span><span class="o">();</span> <span class="o">}</span> <span class="k">return</span> <span class="n">clientes</span><span class="err">\</span><span class="o">[</span><span class="n">nombreHilo</span><span class="err">\</span><span class="o">];</span> <span class="o">}</span>

<span class="kd">public</span> <span class="kt">int</span> <span class="nf">generarAleatorio</span><span class="o">(</span><span class="kt">int</span> <span class="n">min</span><span class="o">,</span> <span class="kt">int</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span> <span class="k">return</span> <span class="n">min</span> <span class="o">+</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="err">\</span><span class="o">*</span> <span class="n">max</span><span class="o">);</span> <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div> <h3 id="content-license"> <a href="#content-license" class="anchor-head"></a> Content License </h3> <p>Creative Commons <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/"><img src="88x311.png" alt="License: CC BY-NC-ND 4.0" /></a></p> <p>This web page, all content with proyects and source code, is licensed under Creative Commons: Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0) <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">More info</a></p> <p>Esta página web y todo su contenido, incluido proyectos y código fuente, está licenciado bajo una licencia de Creative Commons: Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0) <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.es">Más info</a></p> </div> </article> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/hilos-en-java-ejercicio-1-applet/" > <div class="nav-arrow">Previous</div> <span class="post-title">Hilos en JAVA, ejercicio nivel avanzado 1.1 (applet)</span> </a> <a class="post-nav-item post-nav-next" href="/c-tetris/"> <div class="nav-arrow">Next</div> <span class="post-title">C# Tetris</span> </a> </nav> <footer class="footer"> <a class="footer_item" href="/contacto">contact</a>|&nbsp; <a class="footer_item" href="/cv">cv</a>|&nbsp; <a class="footer_item" href="/cookies">cookies</a>|&nbsp; <a class="footer_item" href="/license">license of content</a>|&nbsp; <span class="footer_item">&copy; 2021</span> <small class="footer_copyright"> <!-- Klisé Theme: https://github.com/piharpi/jekyll-klise --> <a href="https://github.com/piharpi/jekyll-klise" target="_blank" rel="noreferrer noopener" >klisé</a > theme on <a href="https://jekyllrb.com" target="_blank" rel="noreferrer noopener" >jekyll</a > </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> </div> </body> </html>
