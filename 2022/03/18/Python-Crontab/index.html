<!DOCTYPE html>
<style>
  .alert {
    padding: 20px;
    background-color: #ff9203;
    text-align: center;
  }

  .alert a{
    color: white;
    text-decoration: none;
  }

  .closebtn {
    margin-left: 15px;
    color: white;
    font-weight: bold;
    float: right;
    font-size: 22px;
    line-height: 20px;
    cursor: pointer;
    transition: 0.3s;
  }

  .closebtn:hover {
    color: black;
  }
</style>







<html lang="en">




<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Python - Programación de scripts mediante crontab en pyton</title>
  <meta name='description'
    content='Proyecto de webscraping: consiste en la captación de un listado con las ofertas de trabajo del portal *ticjob.es* para el lenguaje de programación Python y l...'>

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css?family=Dancing+Script%7CPT+Serif:400,400i,700%7CLato:400,700%7CRoboto:300,400"
    rel="stylesheet">

  <!-- Font Awesome v6.4.2 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

  <!-- Normalize v7.0.0 -->
  <link rel="stylesheet" href="/css/normalize.css">

  <!-- Main Stylesheet -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://rarcos.com/2022/03/18/Python-Crontab/">
  <link rel="alternate" type="application/rss+xml" title="Rubén Arcos" href="/feed.xml">

  <!-- Chrome, Firefox OS and Opera -->
  <meta name="theme-color" content="#faf5ee">
  <!-- Windows Phone -->
  <meta name="msapplication-navbutton-color" content="#faf5ee">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-status-bar-style" content="#faf5ee">
  <!-- Start cookieyes banner --> 
  <script id="cookieyes" type="text/javascript" src="https://cdn-cookieyes.com/client_data/6ae1ee7e40cef2c175ff9462/script.js"></script> 
  <!-- End cookieyes banner -->
</head>



  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VL018H86JE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'G-VL018H86JE');
</script> <!-- /Google Analytics -->
  

  <div class="full-page-container">
    <div class="overlay"></div>
    <header class="site-header clearfix">
  <div class="wrapper-content">

    <div class="switch-lang">
      
      
      <!--en-->
      
      
      
      
      <a id="switch-lang" href="/es/2022/03/18/Python-Crontab/" title="Change language to es">
        <img src="https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/es.png">
      </a>
      
      
      
    </div>

    <div class="navigation-wrap">
      <div class="nav-toggle-close"><i class="fa fa-times" aria-hidden="true"></i></div>

      <nav class="site-nav">
        
        
        
        
        
        
        
      
      
      
      
      
      <a href='/about/'>About me</a>
      
      
      
        
        
        
        
        
        
        
      
      
      
      
      
      <a href='/contacto/'>Contact</a>
      
      
      
        
        
        
        
        
        
        
      
      
      
      
      
      <a href='/cookies/'>Cookies</a>
      
      
      
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <a href="https://linkedin.com/in/rubenarcos2"><i class="fa-brands fa-linkedin fa-2x" aria-hidden="true"></i></a>
        <a href="https://github.com/rubenarcos2"><i class="fa-brands fa-github fa-2x" aria-hidden="true"></i></a>
      </nav>

    </div>

    <span class="search-toggle">
      <i class="fa fa-search" aria-hidden="true"></i>
    </span>

    <div class="nav-toggle"><i class="fa fa-bars" aria-hidden="true"></i></div>

    <div class="site-logo">
      <a href="/">Rubén Arcos</a>
    </div>

  </div>
</header> <!-- /.site-header -->
    <div class="search-box">
  <div class="wrapper-content">
    <form class="search-form">
      
      
      
      
      
      
      <label class="screen-reader-text" for="search-input">Search...</label>
      <input type="text" id="search-input" class="search-field" name="s" placeholder="Search...">
      
      
      

    </form>
    <div class="btn-close">
      <span class="bt-search-close">
        <i class="fa fa-times" aria-hidden="true"></i>
      </span>
    </div>
  </div>
  <ul id="results-container" class="search-results-list"></ul>
</div> <!-- /.search-box -->
    
    
    
    
    
    
    
    <div class="alert">
      <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span> 
      <a href="https://www.linkedin.com/in/rubenarcos2/">Job offers, proposals or other initiatives send them to me via LinkedIn</a>
    </div>
    
    
    

    <div class="post-header" style="background: url(/images/pages/crontab.png)">
  <div class="post-header-info">
    <h1 class="post-title">Python - Programación de scripts mediante crontab en pyton</h1>
    <div class="post-meta">
      
      
      
      
      
      
      <time datetime="2022-03-18T15:33:28+01:00">
         03-18-2022
      </time>
      
      
      
      
    </div>
  </div>
</div>
<div id="readPostContent" style="text-align:center"><a class="btn btn-middle" onclick="readPostContent(this)">
    
    
    
    
    
    
    Read article aloud
    
    
    
  </a></div>
<div class="content-box">
  <article class="post">

    <div class="post-content">
      <h1 id="crontab">Crontab</h1>

<p>Cron es una utilidad que nos permite programar tareas en sistemas basados en Unix utilizando expresiones Cron. Las tareas en cron se definen en un crontab, que es un archivo de texto que contiene los comandos a ejecutar. La sintaxis utilizada en un crontab se describe más adelante en este artículo.
Python nos presenta el módulo crontab para gestionar los trabajos programados a través de cron. Las funciones disponibles en él permiten acceder a cron, crear trabajos, establecer restricciones, eliminar trabajos y mucho más sin tener que escribir manualmente los archivos crontab. En este artículo, mostraremos cómo utilizar estas operaciones desde tu código Python.</p>

<p>Cron utiliza una sintaxis específica para definir los horarios. Consta de cinco campos, separados por espacios en blanco. Los campos son:</p>

<p><img src="https://miro.medium.com/max/875/0*3S3I1pVZY6ZG-x-G.png" alt="image1" /></p>

<ul>
  <li>Resaltar que este script solamente puede ser utilizado en un <strong>entorno linux</strong>.</li>
  <li>Para la misma tarea en <strong>windows</strong> ver este <a href="#https://datatofish.com/python-script-windows-scheduler/">tutorial</a>.</li>
  <li>Para eliminar la tarea después de haberla probado, estos son los <a href="https://linuxhint.com/delete-cron-job-linux/">pasos a seguir</a>.</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1">############################################################################################
##### ESTE SCRIPT SOLO PUEDE SER EJECUTADO EN UN ENTORNO LINUX                  ############
##### THIS SCRIPT CAN ONLY BE RUN IN A LINUX ENVIRONMENT                        ############
############################################################################################
</span>
<span class="kn">from</span> <span class="n">crontab</span> <span class="kn">import</span> <span class="n">CronTab</span>
<span class="kn">import</span> <span class="n">pwd</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">shutil</span>

<span class="c1">#/opt/jobs_offer must have permissions for the script to create the token.pickle file the first time. This is a dependency on email sending.
#They have to be absolute routes, change before using
</span><span class="k">def</span> <span class="nf">uploadScript</span><span class="p">():</span>
    <span class="n">src_path</span> <span class="o">=</span> <span class="sa">r</span><span class="sh">"</span><span class="s">ruta_absoluta/script_lanzado.py</span><span class="sh">"</span>
    <span class="n">dst_path</span> <span class="o">=</span> <span class="sa">r</span><span class="sh">"</span><span class="s">/opt/carpeta_destino/script_lanzado.py</span><span class="sh">"</span>
    <span class="n">shutil</span><span class="p">.</span><span class="nf">copy</span><span class="p">(</span><span class="n">src_path</span><span class="p">,</span> <span class="n">dst_path</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Copied all files</span><span class="sh">'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">add_cron</span><span class="p">():</span>
    <span class="n">cron</span> <span class="o">=</span> <span class="nc">CronTab</span><span class="p">(</span><span class="n">pwd</span><span class="p">.</span><span class="nf">getpwuid</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">getuid</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># For current user
</span>    <span class="c1"># 8:00 am all days in the morning
</span>    <span class="n">basic_command</span> <span class="o">=</span> <span class="sh">"</span><span class="s">0 8 * * 0-6 python3 /opt/jobs_offer/jobs_offer_task.py</span><span class="sh">"</span>
    <span class="n">basic_iter</span> <span class="o">=</span> <span class="n">cron</span><span class="p">.</span><span class="nf">find_command</span><span class="p">(</span><span class="sh">"</span><span class="s">jobs_offer_task</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">exists</span><span class="o">=</span><span class="bp">False</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">basic_iter</span><span class="p">:</span>
        <span class="k">if</span> <span class="nf">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="n">basic_command</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">crontab job already exist</span><span class="sh">"</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="n">exists</span><span class="o">=</span><span class="bp">True</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">:</span>
        <span class="n">job</span> <span class="o">=</span> <span class="n">cron</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="sh">'</span><span class="s">python3 /opt/jobs_offer_task.py</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">job</span><span class="p">.</span><span class="n">minute</span><span class="p">.</span><span class="nf">every</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">job</span><span class="p">.</span><span class="nf">enable</span><span class="p">()</span>
        <span class="n">cron</span><span class="p">.</span><span class="nf">write</span><span class="p">()</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Job added to crontab, ok</span><span class="sh">'</span><span class="p">)</span>

<span class="nf">uploadScript</span><span class="p">()</span>
<span class="nf">add_cron</span><span class="p">()</span></code></pre></figure>

<hr />
<p><strong>Fuentes:</strong></p>

<p><a href="https://medium.com/@django.course/7-ways-to-execute-scheduled-jobs-with-python-47d481d22b91">https://medium.com/@django.course/7-ways-to-execute-scheduled-jobs-with-python-47d481d22b91</a>
<a href="https://linuxhint.com/delete-cron-job-linux/">https://linuxhint.com/delete-cron-job-linux/</a></p>

    </div>

    <footer class="post-footer">
      
      
      
      
      
      
      <p>
      <h3>Content License</h3>

      <p><img src="/images/pages/88x311.png" /></p>

      <p>This web page, all content with proyects and source code, is licensed under Creative Commons:
        Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0) <a
          href="https://creativecommons.org/licenses/by-nc-nd/4.0/">More info</a></p>

      </p>
      
      
      

      <ul class="post-footer-list">
        <li class="post-footer-item">
          <a class="post-facebook"
            href="https://www.facebook.com/sharer/sharer.php?u=https://rarcos.com/2022/03/18/Python-Crontab/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Facebook" rel="nofollow"><i class="fa-brands fa-facebook"
              aria-hidden="true"></i><span>Facebook</span></a>
        </li>

        <li class="post-footer-item">
          <a class="post-twitter"
            href="https://twitter.com/intent/tweet?text=Python%20-%20Programaci%C3%B3n%20de%20scripts%20mediante%20crontab%20en%20pyton&url=https://rarcos.com/2022/03/18/Python-Crontab/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Twitter" rel="nofollow"><i class="fa-brands fa-x-twitter"
              aria-hidden="true"></i><span>Twitter</span></a>
        </li>

        <li class="post-footer-item">
          <a href="http://pinterest.com/pin/create/button/?url=https://rarcos.com/2022/03/18/Python-Crontab/&amp;media=https://rarcos.com/images/pages/crontab.png&amp;description=Python%20-%20Programaci%C3%B3n%20de%20scripts%20mediante%20crontab%20en%20pyton"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"
            class="post-pinterest" title="Share on Pinterest" rel="nofollow"><i class="fa-brands fa-pinterest"
              aria-hidden="true"></i><span>Pinterest</span></a>
        </li>

        <li class="post-footer-item">
          <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://rarcos.com/2022/03/18/Python-Crontab/&title=Python%20-%20Programaci%C3%B3n%20de%20scripts%20mediante%20crontab%20en%20pyton"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"
            class="post-linkedin" title="Share on Linkedin" rel="nofollow"><i class="fa-brands fa-linkedin"
              aria-hidden="true"></i><span>Linkedin</span></a>
        </li>
      </ul>
      
      <div class="post-tag">
        <span>Tags:</span>
        
        <a href="/tags#python" class="tag">python</a>
        
        <a href="/tags#webscraping" class="tag">webscraping</a>
        
        <a href="/tags#cron" class="tag">cron</a>
        
        <a href="/tags#crontab" class="tag">crontab</a>
        
      </div>
      
    </footer>

    
    <div class="post-author">
      
      <div class="post-author-image">
        <a style="background-image: url(/images/ruben.jpg)">
          <span class="screen-reader-text">Rubén Arcos Picture</span>
        </a>
      </div>
      <div class="post-author-info">
        <h4>Rubén Arcos</h4>
        <p class="post-author-bio">
          
          
          
          
          
          
          IT Developer. <br>Higher Education Master in AI and Big Data, <br>Higher Technician in Web Applications Development and <br>Higher Technician in Multiplatform Applications Development.
          
          
          
        </p>
        <div class="post-author-meta">
          
          <a href="https://twitter.com/rarcosdev" target="_blank"><i class="fa-brands fa-x-twitter" aria-hidden="true"></i></a>
          
          
          <a href="https://linkedin.com/in/rubenarcos2" target="_blank"><i class="fa-brands fa-linkedin" aria-hidden="true"></i></a>
          
          
          <a href="https://github.com/rubenarcos2" target="_blank"><i class="fa-brands fa-github" aria-hidden="true"></i></a>
          
          
          
          
          
          
          
          
          
        </div>
      </div>
      
    </div>

    <div class="page-navigation clearfix">
      
      <a class="prev-page" href="/2022/03/16/Python-Keras_IA_tf.js/"><i class="fa fa-angle-left"
          aria-hidden="true"></i><span>Python - Modelo de IA en Keras con exportación a tensorflow js</span></a>
      
      
      <a class="next-page" href="/2022/03/18/Python-Gmail_api/"><span>Python - Envío de emails mediante la api de Gmail con python</span><i class="fa fa-angle-right"
          aria-hidden="true"></i></a>
      
    </div>

    
  </article> <!-- /.post -->

</div> <!-- /.content-box -->

    <div class="top" title="Scroll To Top">
  <i class="fa fa-chevron-up" aria-hidden="true"></i>
</div> <!-- /.top -->
    <footer class="site-footer">

  <div class="footer-wrapper">

    <h2 class="footer-heading">Rubén Arcos</h2>

    <ul class="social-footer">
    
      <li><a href="https://twitter.com/rarcosdev" target="_blank"><i class="fa-brands fa-x-twitter" aria-hidden="true"></i></a></li>
    
    
    
    
    <li><a href="https://linkedin.com/in/rubenarcos2" target="_blank"><i class="fa-brands fa-linkedin" aria-hidden="true"></i></a></li>
    
    
    <li><a href="https://github.com/rubenarcos2" target="_blank"><i class="fa-brands fa-github" aria-hidden="true"></i></a></li>
    
    
    
    
    
    
    
    
    
    </ul>

    <div class="copyright">
      <p><a href="https://jekyllrb.com/">Proudly powered by Jekyll</a> | Theme: Lokmont by <a href="https://artemsheludko.github.io/">Artem Sheludko</a> | Modifications: <a href="https://github.com/rubenarcos2">Rubén Arcos</a></p>
    </div>
  </div>

</footer> <!-- /.site-footer -->

  </div> <!-- /.full-page-container -->

  <script src="/js/jquery-3.7.1.min.js"></script>
<script src="/js/jquery.viewportchecker.min.js"></script>
<script src="/js/jquery.fitvids.js"></script>
<script src="/js/simple-jekyll-search.min.js"></script>
<script src="/js/transition.js"></script>
<script src="/js/zoom.min.js"></script>
<script src="/js/main.js"></script>
</body>

</html>