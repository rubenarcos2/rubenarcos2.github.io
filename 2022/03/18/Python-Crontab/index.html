<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Python - Programación de scripts mediante crontab en pyton</title>
  <meta name='description'
    content='Proyecto de webscraping: consiste en la captación de un listado con las ofertas de trabajo del portal *ticjob.es* para el lenguaje de programación Python y l...'>

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css?family=Dancing+Script%7CPT+Serif:400,400i,700%7CLato:400,700%7CRoboto:300,400"
    rel="stylesheet">

  <!-- Font Awesome v4.7.0 -->
  <link rel="stylesheet" href="/css/font-awesome.min.css">

  <!-- Normalize v7.0.0 -->
  <link rel="stylesheet" href="/css/normalize.css">

  <!-- Main Stylesheet -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://rarcos.com//2022/03/18/Python-Crontab/">
  <link rel="alternate" type="application/rss+xml" title="Rubén Arcos" href="/%20/feed.xml">

  <!-- Chrome, Firefox OS and Opera -->
  <meta name="theme-color" content="#faf5ee">
  <!-- Windows Phone -->
  <meta name="msapplication-navbutton-color" content="#faf5ee">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-status-bar-style" content="#faf5ee">
</head>
  
  
  
    
      <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-64172909-1', 'auto');
  ga('send', 'pageview');

</script> <!-- /Google Analytics -->
  

    

    <div class="full-page-container">
      <div class="overlay"></div>
      <header class="site-header clearfix">
  <div class="wrapper-content">

    <div class="navigation-wrap">
      <div class="nav-toggle-close"><i class="fa fa-times" aria-hidden="true"></i></div>

      <nav class="site-nav">
        
          
        
          
            
              <a href='/about/'>Sobre mí</a>
            
          
        
          
            
              <a href='/contacto/'>Contacto</a>
            
          
        
          
            
              <a href='/cookies/'>Cookies</a>
            
          
        
          
            
          
        
          
            
          
        
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
        <a href="https://linkedin.com/in/rubenarcos2"><i class="fa fa-linkedin fa-2x" aria-hidden="true"></i></a>
        <a href="https://github.com/rubenarcos2"><i class="fa fa-github fa-2x" aria-hidden="true"></i></a>
      </nav>
      
    </div>

    <span class="search-toggle">
      <i class="fa fa-search" aria-hidden="true"></i>
    </span>
    
    <div class="nav-toggle"><i class="fa fa-bars" aria-hidden="true"></i></div>

    <div class="site-logo">
      <a href="/">Rubén Arcos</a>
    </div>
    
  </div>
</header> <!-- /.site-header -->

      <div class="search-box">
  <div class="wrapper-content">
    <form class="search-form">
      <label class="screen-reader-text" for="search-input">Buscar...</label>
      <input type="text" id="search-input" class="search-field" name="s" placeholder="Type to search...">
    </form>
    <div class="btn-close">
      <span class="bt-search-close">
        <i class="fa fa-times" aria-hidden="true"></i>
      </span>
    </div>
  </div>
  <ul id="results-container" class="search-results-list"></ul>  
</div> <!-- /.search-box -->

        <div class="post-header" style="background: url(/images/pages/crontab.png)">
  <div class="post-header-info">
    <h1 class="post-title">Python - Programación de scripts mediante crontab en pyton</h1>
    <div class="post-meta">
      <time datetime="2022-03-18T15:33:28+01:00">
         18/03/2022
      </time>
    </div>
  </div>
</div>

<div class="content-box">
  <article class="post">

    <div class="post-content">
      <h1 id="crontab">Crontab</h1>

<p>Cron es una utilidad que nos permite programar tareas en sistemas basados en Unix utilizando expresiones Cron. Las tareas en cron se definen en un crontab, que es un archivo de texto que contiene los comandos a ejecutar. La sintaxis utilizada en un crontab se describe más adelante en este artículo.
Python nos presenta el módulo crontab para gestionar los trabajos programados a través de cron. Las funciones disponibles en él permiten acceder a cron, crear trabajos, establecer restricciones, eliminar trabajos y mucho más sin tener que escribir manualmente los archivos crontab. En este artículo, mostraremos cómo utilizar estas operaciones desde tu código Python.</p>

<p>Cron utiliza una sintaxis específica para definir los horarios. Consta de cinco campos, separados por espacios en blanco. Los campos son:</p>

<p><img src="https://miro.medium.com/max/875/0*3S3I1pVZY6ZG-x-G.png" alt="image1" /></p>

<ul>
  <li>Resaltar que este script solamente puede ser utilizado en un <strong>entorno linux</strong>.</li>
  <li>Para la misma tarea en <strong>windows</strong> ver este <a href="#https://datatofish.com/python-script-windows-scheduler/">tutorial</a>.</li>
  <li>Para eliminar la tarea después de haberla probado, estos son los <a href="https://linuxhint.com/delete-cron-job-linux/">pasos a seguir</a>.</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1">############################################################################################
##### ESTE SCRIPT SOLO PUEDE SER EJECUTADO EN UN ENTORNO LINUX                  ############
##### THIS SCRIPT CAN ONLY BE RUN IN A LINUX ENVIRONMENT                        ############
############################################################################################
</span>
<span class="kn">from</span> <span class="nn">crontab</span> <span class="kn">import</span> <span class="n">CronTab</span>
<span class="kn">import</span> <span class="nn">pwd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>

<span class="c1">#/opt/jobs_offer must have permissions for the script to create the token.pickle file the first time. This is a dependency on email sending.
#They have to be absolute routes, change before using
</span><span class="k">def</span> <span class="nf">uploadScript</span><span class="p">():</span>
    <span class="n">src_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s">"ruta_absoluta/script_lanzado.py"</span>
    <span class="n">dst_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s">"/opt/carpeta_destino/script_lanzado.py"</span>
    <span class="n">shutil</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="n">src_path</span><span class="p">,</span> <span class="n">dst_path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Copied all files'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">add_cron</span><span class="p">():</span>
    <span class="n">cron</span> <span class="o">=</span> <span class="n">CronTab</span><span class="p">(</span><span class="n">pwd</span><span class="p">.</span><span class="n">getpwuid</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">getuid</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># For current user
</span>    <span class="c1"># 8:00 am all days in the morning
</span>    <span class="n">basic_command</span> <span class="o">=</span> <span class="s">"0 8 * * 0-6 python3 /opt/jobs_offer/jobs_offer_task.py"</span>
    <span class="n">basic_iter</span> <span class="o">=</span> <span class="n">cron</span><span class="p">.</span><span class="n">find_command</span><span class="p">(</span><span class="s">"jobs_offer_task"</span><span class="p">)</span>
    <span class="n">exists</span><span class="o">=</span><span class="bp">False</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">basic_iter</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="n">basic_command</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"crontab job already exist"</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="n">exists</span><span class="o">=</span><span class="bp">True</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">:</span>
        <span class="n">job</span> <span class="o">=</span> <span class="n">cron</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="s">'python3 /opt/jobs_offer_task.py'</span><span class="p">)</span>
        <span class="n">job</span><span class="p">.</span><span class="n">minute</span><span class="p">.</span><span class="n">every</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">job</span><span class="p">.</span><span class="n">enable</span><span class="p">()</span>
        <span class="n">cron</span><span class="p">.</span><span class="n">write</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Job added to crontab, ok'</span><span class="p">)</span>

<span class="n">uploadScript</span><span class="p">()</span>
<span class="n">add_cron</span><span class="p">()</span></code></pre></figure>

<hr />
<p><strong>Fuentes:</strong></p>

<p><a href="https://medium.com/@django.course/7-ways-to-execute-scheduled-jobs-with-python-47d481d22b91">https://medium.com/@django.course/7-ways-to-execute-scheduled-jobs-with-python-47d481d22b91</a>
<a href="https://linuxhint.com/delete-cron-job-linux/">https://linuxhint.com/delete-cron-job-linux/</a></p>

    </div>

    <footer class="post-footer">
      <p>
        <h3>Content License</h3>

        <p><img src="/images/pages/88x311.png"/></p>
        
        <p>This web page, all content with proyects and source code, is licensed under Creative Commons: Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0) <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">More info</a></p>
        
        <p>Esta página web y todo su contenido, incluido proyectos y código fuente, está licenciado bajo una licencia de Creative Commons: Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.es">Más info</a></p>
        
      </p>

      <ul class="post-footer-list">
        <li class="post-footer-item">
          <a class="post-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://rarcos.com//2022/03/18/Python-Crontab/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook" rel="nofollow"><i class="fa fa-facebook" aria-hidden="true"></i><span>Facebook</span></a>
        </li>

        <li class="post-footer-item">
          <a class="post-twitter" href="https://twitter.com/intent/tweet?text=Python%20-%20Programaci%C3%B3n%20de%20scripts%20mediante%20crontab%20en%20pyton&url=https://rarcos.com//2022/03/18/Python-Crontab/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter" rel="nofollow"><i class="fa fa-twitter" aria-hidden="true"></i><span>Twitter</span></a>
        </li>

        <li class="post-footer-item">
          <a href="http://pinterest.com/pin/create/button/?url=https://rarcos.com//2022/03/18/Python-Crontab/&amp;media=https://rarcos.com//images/pages/crontab.png&amp;description=Python%20-%20Programaci%C3%B3n%20de%20scripts%20mediante%20crontab%20en%20pyton" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" class="post-pinterest" title="Share on Pinterest" rel="nofollow"><i class="fa fa-pinterest" aria-hidden="true"></i><span>Pinterest</span></a>
        </li>
      </ul>
      
      <div class="post-tag">
        <span>Tags:</span>
        
        <a href="/tags#python" class="tag">python</a>
        
        <a href="/tags#webscraping" class="tag">webscraping</a>
        
        <a href="/tags#cron" class="tag">cron</a>
        
        <a href="/tags#crontab" class="tag">crontab</a>
        
      </div>
      
    </footer>

    
    <div class="post-author">
      
      <div class="post-author-image">
        <a style="background-image: url(/images/ruben.jpg)">
          <span class="screen-reader-text">Rubén Arcos Picture</span>
        </a>
      </div>
      <div class="post-author-info">
        <h4>Rubén Arcos</h4>
        <p class="post-author-bio">Soy desarrollador de aplicaciones informáticas. <br>Tengo un C.F.G.S. en DAM y estoy haciendo un curso de especialización en IA y Big data.</p>
        <div class="post-author-meta">
          
          <a href="https://twitter.com/rarcosdev" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
          
          
          <a href="https://linkedin.com/in/rubenarcos2" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
          
          
          <a href="https://github.com/rubenarcos2" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a>
          
          
          
          
          
          
          
          
          
        </div>
      </div>
      
    </div>

    <div class="page-navigation clearfix">
      
      <a class="prev-page" href="/2022/03/16/Python-Keras_IA_tf.js/"><i class="fa fa-angle-left" aria-hidden="true"></i><span>Python - Modelo de IA en Keras con exportación a tensorflow js</span></a>
      
      
      <a class="next-page" href="/2022/03/18/Python-Gmail_api/"><span>Python - Envío de emails mediante la api de Gmail con python</span><i class="fa fa-angle-right" aria-hidden="true"></i></a>
      
    </div>

    
  </article> <!-- /.post -->

</div> <!-- /.content-box -->
<style>
    #cookie-notice {padding: 0.5rem 1rem; display: none; text-align: center; position: fixed; bottom: 0; width: calc(100% - 2rem); background: #222; color: rgba(255,255,255,0.8);}
    #cookie-notice a {display: inline-block; cursor: pointer; margin-left: 0.5rem;}
    @media (max-width: 767px) {
        #cookie-notice span {display: block; padding-top: 3px; margin-bottom: 1rem;}
        #cookie-notice a {position: relative; bottom: 4px;}
    }
</style>
<div id="cookie-notice"><span>Esta web utiliza cookies y scripts de terceros para mejorar la funcionalidad de este sitio web.</span>
    <a id="cookie-notice-accept" class="btn btn-primary btn-sm">Aceptar</a><a href="/cookies" class="btn btn-primary btn-sm">Más info</a></div>
<script>
    function createCookie(name,value,days) {
        var expires = "";
        if (days) {
            var date = new Date();
            date.setTime(date.getTime() + (days*24*60*60*1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + value + expires + "; path=/";
    }
    function readCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for(var i=0;i < ca.length;i++) {
            var c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
        }
        return null;
    }
    function eraseCookie(name) {
        createCookie(name,"",-1);
    }

    if(readCookie('cookie-notice-dismissed')=='true') {

    } else {
        document.getElementById('cookie-notice').style.display = 'block';
    }
    document.getElementById('cookie-notice-accept').addEventListener("click",function() {
        createCookie('cookie-notice-dismissed','true',31);
        document.getElementById('cookie-notice').style.display = 'none';
        location.reload();
    });

</script>


      <div class="top" title="Scroll To Top">
  <i class="fa fa-chevron-up" aria-hidden="true"></i>
</div> <!-- /.top -->
      <footer class="site-footer">

  <div class="footer-wrapper">

    <h2 class="footer-heading">Rubén Arcos</h2>

    <ul class="social-footer">
    
      <li><a href="https://twitter.com/rarcosdev" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
    
    
    
    
    <li><a href="https://linkedin.com/in/rubenarcos2" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
    
    
    <li><a href="https://github.com/rubenarcos2" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a></li>
    
    
    
    
    
    
    
    
    
    </ul>

    <div class="copyright">
      <p><a href="https://jekyllrb.com/">Proudly powered by Jekyll</a> | Theme: Lokmont by <a href="https://artemsheludko.github.io/">Artem Sheludko</a></p>
    </div>
  </div>

</footer> <!-- /.site-footer -->

    </div> <!-- /.full-page-container -->

    <script src="/js/jquery-3.2.1.min.js"></script>
<script src="/js/jquery.viewportchecker.min.js"></script>
<script src="/js/jquery.fitvids.js"></script>
<script src="/js/simple-jekyll-search.min.js"></script>
<script src="/js/transition.js"></script>
<script src="/js/zoom.min.js"></script>
<script src="/js/main.js"></script>
    <style>
    #cookie-notice {padding: 0.5rem 1rem; display: none; text-align: center; position: fixed; bottom: 0; width: calc(100% - 2rem); background: #222; color: rgba(255,255,255,0.8);}
    #cookie-notice a {display: inline-block; cursor: pointer; margin-left: 0.5rem;}
    @media (max-width: 767px) {
        #cookie-notice span {display: block; padding-top: 3px; margin-bottom: 1rem;}
        #cookie-notice a {position: relative; bottom: 4px;}
    }
</style>
<div id="cookie-notice"><span>Esta web utiliza cookies y scripts de terceros para mejorar la funcionalidad de este sitio web.</span>
    <a id="cookie-notice-accept" class="btn btn-primary btn-sm">Aceptar</a><a href="/cookies" class="btn btn-primary btn-sm">Más info</a></div>
<script>
    function createCookie(name,value,days) {
        var expires = "";
        if (days) {
            var date = new Date();
            date.setTime(date.getTime() + (days*24*60*60*1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + value + expires + "; path=/";
    }
    function readCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for(var i=0;i < ca.length;i++) {
            var c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
        }
        return null;
    }
    function eraseCookie(name) {
        createCookie(name,"",-1);
    }

    if(readCookie('cookie-notice-dismissed')=='true') {

    } else {
        document.getElementById('cookie-notice').style.display = 'block';
    }
    document.getElementById('cookie-notice-accept').addEventListener("click",function() {
        createCookie('cookie-notice-dismissed','true',31);
        document.getElementById('cookie-notice').style.display = 'none';
        location.reload();
    });

</script>
  </body>

</html>
